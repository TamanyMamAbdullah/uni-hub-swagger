paths:
  /api/v1/auth/register:
    post:
      tags: [Authentication]
      summary: Register a new user
      description: Creates a new account using email and password.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../shared.yaml#/components/schemas/RegisterRequest"
            example:
              email: "student@example.com"
              password: "StrongPassword123"
              firstName: "John"
              lastName: "Doe"
      responses:
        "201":
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/SuccessResponse"
              example:
                success: true
                data:
                  user:
                    id: "uuid-123"
                    email: "student@example.com"
                    firstName: "John"
                    lastName: "Doe"
                    isVerified: false
                meta: {}
                timestamp: "2025-01-20T12:00:00Z"
        "400":
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/ErrorResponse"

  /api/v1/auth/login:
    post:
      tags: [Authentication]
      summary: Login user
      description: Validates user credentials and returns access + refresh tokens.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../shared.yaml#/components/schemas/LoginRequest"
            example:
              email: "student@example.com"
              password: "StrongPassword123"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/LoginResponse"
              example:
                success: true
                data:
                  accessToken: "jwt-access-token"
                  refreshToken: "jwt-refresh-token"
                  user:
                    id: "uuid-123"
                    email: "student@example.com"
                    firstName: "John"
                    lastName: "Doe"
                meta: {}
                timestamp: "2025-01-20T12:00:00Z"
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/ErrorResponse"

  /api/v1/auth/refresh:
    post:
      tags: [Authentication]
      summary: Refresh the access token
      description: Generates a new access token using a valid refresh token.
      responses:
        "200":
          description: New access token created
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/TokenRefreshResponse"
              example:
                success: true
                data:
                  accessToken: "new-jwt-access-token"
                meta: {}
                timestamp: "2025-01-20T12:00:00Z"
        "401":
          description: Refresh token expired or invalid
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/ErrorResponse"

  /api/v1/auth/logout:
    post:
      tags: [Authentication]
      summary: Logout user
      description: Invalidates the refresh token and logs the user out.
      responses:
        "200":
          description: Logged out successfully
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/SuccessResponse"
                example:
                  success: true
                  data:
                    message: "Logged out successfully"
                  meta: {}
                  timestamp: "2025-01-20T12:00:00Z"

  /api/v1/auth/verify-email:
    post:
      tags: [Authentication]
      summary: Verify user email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../shared.yaml#/components/schemas/VerifyEmailRequest"
            example:
              token: "verification-token"
      responses:
        "200":
          description: Email verified
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/SuccessResponse"
        "400":
          description: Invalid token
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/ErrorResponse"

  /api/v1/auth/forgot-password:
    post:
      tags: [Authentication]
      summary: Request password reset email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../shared.yaml#/components/schemas/ForgotPasswordRequest"
            example:
              email: "student@example.com"
      responses:
        "200":
          description: Email sent
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/SuccessResponse"

  /api/v1/auth/reset-password:
    post:
      tags: [Authentication]
      summary: Reset password using a token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../shared.yaml#/components/schemas/ResetPasswordRequest"
            example:
              token: "reset-token"
              newPassword: "NewStrongPassword123"
      responses:
        "200":
          description: Password reset successful
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/SuccessResponse"
        "400":
          description: Invalid token or password
          content:
            application/json:
              schema:
                $ref: "../shared.yaml#/components/schemas/ErrorResponse"

components:
  schemas:
    # --- Requests ---

    RegisterRequest:
      type: object
      required: [email, password, firstName, lastName]
      properties:
        email:
          type: string
          format: email
        password:
          type: string
        firstName:
          type: string
        lastName:
          type: string

    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
        password:
          type: string

    VerifyEmailRequest:
      type: object
      required: [token]
      properties:
        token:
          type: string

    ForgotPasswordRequest:
      type: object
      required: [email]
      properties:
        email:
          type: string
          format: email

    ResetPasswordRequest:
      type: object
      required: [token, newPassword]
      properties:
        token:
          type: string
        newPassword:
          type: string

    # --- Responses ---

    LoginResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            accessToken:
              type: string
            refreshToken:
              type: string
            user:
              $ref: "../shared.yaml#/components/schemas/UserSummary"
        meta:
          $ref: "../shared.yaml#/components/schemas/Meta"
        timestamp:
          type: string
          format: date-time

    TokenRefreshResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            accessToken:
              type: string
        meta:
          $ref: "../shared.yaml#/components/schemas/Meta"
        timestamp:
          type: string
          format: date-time
